<html lang="id"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6ImYwZjI0YjNjZGNmMjUwNzA5NWVlMDNmZWQxYWExYzRjYzFjZjZlY2MiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMzQyOTYyOTc2NjM5MDE4MjExOSIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzViMWU2MTE4MDJjYTAzMTJfaW5kZXguaHRtbC0xMzIifSwiZXhwIjoxNzY0MzAxODU5LCJpYXQiOjE3NjQyOTgyNTksImFsZyI6IlJTMjU2In0.Fm-AEAHGG544PADUGOMNTfbaY_juxZt9CnGKHE4CoJA-HHsYcHaxU8lIra_hwetnpPb_UWsh-fRFaPtJ70HsLJZRSo-G6Nymfhm17sRNET3y0c5M4rF66LSGnS1PO_43eDCdZLUfmweK9j1-gcTLiDZHH9FoZwpOdIR440CRWt3jskw09c6grFu4SE-2H9dQ7I8BPsbagz0LoGfgDlI36hjzu-GD-dLbvRG8STKKN6YDsM3tepiXvf6PgcqaC0X-_8Qc6Z9KPjuW9_TC2Y8NuzR6gbQZeQ0IcjO90Cebd4t4uQXGY8Y2E_1utXCu2OIMXSC1hevV4zxTiaJoDPXRRA","c_5b1e611802ca0312_index.html-132")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGM Strategic Visual Dashboard</title>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>
    <!-- Google Fonts: Playfair Display (Serif) & Lato (Sans) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&amp;family=Playfair+Display:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --bg-deep: #121212; 
            --bg-card: #1e1e1e;
            --bg-header: #000000;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            
            /* Semantic Colors */
            --vc-gold: #c5a059;    
            --vc-teal: #2a9d8f;    
            --vc-coral: #e76f51;   
            --vc-blue: #457b9d;    
            --vc-danger: #d63031;
            --vc-success: #27ae60;

            --border-light: rgba(255,255,255,0.1);
        }

        body {
            font-family: 'Lato', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-deep);
            color: var(--text-main);
            background-image: radial-gradient(#2a2a2a 1px, transparent 1px);
            background-size: 24px 24px;
        }

        h1, h2, h3, .serif-font { font-family: 'Playfair Display', serif; }

        /* --- HEADER & NAV FIXED --- */
        header {
            background-color: var(--bg-header);
            padding: 25px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            position: relative; 
            z-index: 100;
        }

        header h1 { margin: 0; font-size: 24px; color: #fff; letter-spacing: 1px; }
        header .sub-header { font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: var(--vc-gold); margin-top: 5px; }

        .header-right { display: flex; align-items: center; gap: 20px; }
        .confidential { font-size: 12px; color: #666; }
        .save-btn {
            background: var(--vc-gold); color: #000; border: none; padding: 8px 15px;
            border-radius: 20px; font-size: 12px; font-weight: bold; cursor: pointer;
            display: flex; align-items: center; gap: 5px;
        }
        .save-btn:hover { background: #a88547; }

        /* Navigasi */
        .glass-nav-container {
            display: flex;
            justify-content: center;
            margin-top: 20px; 
            margin-bottom: 30px;
            position: sticky;
            top: 20px;
            z-index: 99;
            pointer-events: none; 
        }

        .glass-menu {
            pointer-events: auto;
            display: flex;
            gap: 8px;
            padding: 8px 10px;
            background: rgba(30, 30, 30, 0.8); 
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .glass-btn {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.7);
            padding: 10px 24px;
            border-radius: 40px;
            font-family: 'Lato', sans-serif;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .glass-btn:hover { color: #fff; background: rgba(255,255,255,0.1); }
        .glass-btn.active {
            background: rgba(255,255,255,0.2);
            color: #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .container { max-width: 1600px; margin: 0 auto; padding: 0 30px 60px 30px; }

        /* --- VIEW SECTIONS --- */
        .view-section { display: none; animation: fadeIn 0.5s ease; }
        .view-section.active-view { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- BSC CARDS --- */
        .grid-bsc {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            margin-top: 10px;
        }

        .bsc-card {
            background: var(--bg-card);
            padding: 20px;
            border: 1px solid var(--border-light);
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            border-top-width: 3px;
        }
        .bsc-card:hover { transform: translateY(-5px); border-color: var(--vc-gold); }
        .bsc-card::after { content: 'LIHAT GRAFIK'; position: absolute; bottom: 10px; right: 10px; font-size: 9px; opacity: 0.5; letter-spacing: 1px; }

        .bsc-val { font-family: 'Playfair Display', serif; font-size: 36px; line-height: 1; margin: 10px 0; font-weight: 700; }
        .bsc-label { font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-muted); }
        .bsc-sub { font-size: 12px; color: #777; margin-top: 5px; }

        /* --- INSIGHT PANELS --- */
        .insight-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .insight-box {
            background: #181818;
            border: 1px solid #333;
            padding: 25px;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
        }

        .insight-header {
            display: flex; align-items: center; gap: 10px;
            margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px;
        }
        .insight-title { font-family: 'Playfair Display', serif; font-size: 18px; color: #fff; }
        .insight-icon { color: var(--vc-coral); font-size: 18px; }
        
        .deep-analysis-item { margin-bottom: 20px; padding-left: 15px; border-left: 2px solid var(--vc-coral); }
        .da-fin .deep-analysis-item { border-color: var(--vc-coral); }
        .da-cust .deep-analysis-item { border-color: var(--vc-blue); }
        .da-proc .deep-analysis-item { border-color: var(--vc-teal); }
        .da-grow .deep-analysis-item { border-color: var(--vc-gold); }

        .da-title { font-weight: bold; color: #fff; font-size: 14px; margin-bottom: 5px; display: block; }
        .da-body { color: #ccc; font-size: 13px; line-height: 1.6; }
        .da-root { color: #888; font-size: 12px; margin-top: 8px; font-style: italic; display: block; }
        .da-root::before { content: 'Root Cause: '; font-weight: bold; color: #666; }

        /* --- MATRIX LAYOUT --- */
        .matrix-container {
            display: grid;
            grid-template-columns: 280px 1fr 1fr; 
            grid-template-rows: auto 1fr 1fr;
            gap: 15px;
        }

        .m-box {
            background: var(--bg-card);
            padding: 20px;
            border: 1px solid var(--border-light);
            transition: all 0.2s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            min-height: 220px;
        }
        .m-box:hover { background: #252525; border-color: #555; transform: scale(1.01); z-index: 10; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        .icon-bg { position: absolute; bottom: -20px; right: -20px; font-size: 100px; opacity: 0.03; transition: all 0.5s; pointer-events: none; }
        .m-box:hover .icon-bg { opacity: 0.1; transform: scale(1.1); }

        .box-header { font-size: 10px; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px; opacity: 0.8; font-weight: bold; }
        .box-title { font-family: 'Playfair Display', serif; font-size: 18px; margin-bottom: 10px; line-height: 1.2; color: #fff; }
        
        .box-list { font-size: 12px; color: #aaa; list-style: none; padding: 0; flex: 1; }
        .box-list li { margin-bottom: 5px; display: flex; gap: 8px; align-items: flex-start; line-height: 1.4; }
        .box-list li i { color: #555; flex-shrink: 0; margin-top: 3px; }

        .axis-box { background: #151515; border: 1px solid #333; display: flex; flex-direction: column; justify-content: flex-start; }
        .legend-box { background: transparent; border: none; justify-content: center; align-items: center; text-align: center; cursor: default; min-height: 100px; }
        .legend-title { font-family: 'Playfair Display', serif; font-size: 28px; color: #333; letter-spacing: 5px; font-weight: bold; }

        .border-teal { border-top: 4px solid var(--vc-teal); }
        .border-coral { border-top: 4px solid var(--vc-coral); }
        .border-gold { border-left: 4px solid var(--vc-gold); } 
        .strat-box { background: #1a2634; border: 1px dashed rgba(255,255,255,0.1); }
        .strat-indicator { position: absolute; top: 10px; right: 10px; font-size: 24px; font-weight: 900; color: rgba(255,255,255,0.05); font-family: sans-serif; }

        .text-teal { color: var(--vc-teal); }
        .text-coral { color: var(--vc-coral); }
        .text-gold { color: var(--vc-gold); }
        .text-blue { color: var(--vc-blue); }

        /* --- CPM TABLE STYLES (ENHANCED) --- */
        .cpm-wrapper {
            max-width: 100%;
            overflow-x: auto;
            border: 1px solid #333;
            border-radius: 8px;
            background: #1e1e1e;
        }
        
        .cpm-table { 
            width: 100%; 
            border-collapse: separate; /* Required for sticky */
            border-spacing: 0;
            font-size: 11px; 
            min-width: 1800px; /* Force scroll */
        }
        
        .cpm-table th { 
            background: #111; 
            color: var(--vc-gold); 
            padding: 10px 5px; 
            text-align: center; 
            border-bottom: 1px solid #444; 
            border-right: 1px solid #333;
            position: sticky; 
            top: 0; 
            z-index: 10; 
            font-weight: bold;
        }
        
        .cpm-table td { 
            background: #1e1e1e; 
            padding: 8px 5px; 
            border-bottom: 1px solid #333; 
            border-right: 1px solid #333;
            text-align: center; 
            color: #ddd;
            white-space: nowrap;
        }
        
        .cpm-table tr:hover td { background: #2a2a2a; }
        
        /* Sticky First Columns */
        .cpm-col-sticky {
            position: sticky;
            left: 0;
            z-index: 11;
            background: #1e1e1e;
            border-right: 2px solid #444;
        }
        .cpm-table th.cpm-col-sticky { z-index: 20; background: #111; }
        .cpm-table tr:hover .cpm-col-sticky { background: #2a2a2a; }
        
        .kpi-row-header { text-align: left !important; font-weight: bold; min-width: 250px; padding-left: 10px !important; }
        .uom-col { width: 50px; text-align: center; color: #888; font-size: 10px; }
        
        .section-row { background: #111 !important; color: #fff; font-weight: bold; text-align: left; padding-left: 10px; }
        .section-row td { background: #111 !important; text-align: left; padding: 10px; border-bottom: 2px solid var(--vc-teal); }

        .val-bad { color: var(--vc-coral); font-weight: bold; background: rgba(231, 76, 60, 0.1); }
        .val-good { color: var(--vc-success); font-weight: bold; background: rgba(46, 204, 113, 0.1); }
        .val-neutral { color: #aaa; }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.95); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden; transition: all 0.3s;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-window {
            width: 90%; max-width: 1200px; height: 85vh;
            background: #181818; border: 1px solid #333;
            display: flex; flex-direction: column;
            box-shadow: 0 0 50px #000;
        }

        .mw-header { padding: 20px 30px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; background: #000; }
        .mw-title { font-family: 'Playfair Display', serif; font-size: 24px; color: var(--vc-gold); }
        .mw-close { background: none; border: none; color: #fff; font-size: 24px; cursor: pointer; }

        .mw-body { flex: 1; overflow-y: auto; padding: 30px; }

        /* MINI CHARTS GRID */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .kpi-card {
            background: #222; border: 1px solid #333; border-radius: 8px; padding: 20px;
            display: flex; flex-direction: column;
        }

        .kpi-title { font-size: 12px; color: #aaa; text-transform: uppercase; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .kpi-stat-row { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 5px; }
        .kpi-current { font-size: 24px; font-weight: bold; color: #fff; font-family: 'Playfair Display'; }
        .kpi-trend { font-size: 12px; display: flex; align-items: center; gap: 3px; }
        .trend-up { color: var(--vc-success); }
        .trend-down { color: var(--vc-danger); }
        .mini-chart-container { height: 180px; width: 100%; position: relative; }
        
        .ytd-badge { font-size: 11px; padding: 2px 6px; border-radius: 3px; background: #333; color: #aaa; margin-bottom: 10px; display: inline-block; }
        .ytd-good { color: var(--vc-success); border: 1px solid var(--vc-success); }
        .ytd-warn { color: var(--vc-warning); border: 1px solid var(--vc-warning); }
        .ytd-bad { color: var(--vc-danger); border: 1px solid var(--vc-danger); }

        /* ACCORDION STYLE */
        .accordion-item { border: 1px solid #333; background: #222; margin-bottom: 10px; border-radius: 6px; overflow: hidden; }
        .accordion-header { padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: #2a2a2a; transition: background 0.3s; }
        .accordion-header:hover { background: #333; }
        .accordion-title { font-weight: bold; color: #eee; font-size: 14px; }
        .accordion-icon { transition: transform 0.3s; color: var(--vc-gold); font-size: 12px; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; background: #1a1a1a; }
        .accordion-body { padding: 20px; color: #ccc; font-size: 13px; line-height: 1.6; border-top: 1px solid #333; }
        .accordion-active .accordion-content { max-height: 500px; }
        .accordion-active .accordion-icon { transform: rotate(180deg); }
        .acc-list { padding-left: 20px; margin: 0; }
        .acc-list li { margin-bottom: 5px; }

        @media (max-width: 1024px) {
            .matrix-container { display: flex; flex-direction: column; height: auto; }
            .m-box { min-height: 200px; }
            .grid-bsc { grid-template-columns: 1fr 1fr; }
            .insight-grid { grid-template-columns: 1fr; }
            .header-right { flex-direction: column; align-items: flex-end; gap: 10px; }
        }
    </style>
</head>
<body>

    <header>
        <div>
            <h1>AGM STRATEGIC DASHBOARD</h1>
            <div class="sub-header">PLANNING CYCLE  COMPREHENSIVE DATA VIEW</div>
        </div>
        <div class="header-right">
            <div class="confidential">CONFIDENTIAL</div>
            <button class="save-btn" onclick="savePage()"><i class="fas fa-save"></i> SIMPAN HALAMAN</button>
        </div>
    </header>

    <!-- MENU IOS GLASS -->
    <div class="glass-nav-container">
        <nav class="glass-menu">
            <button class="glass-btn" onclick="switchView('bsc', this)">BSC 2025</button>
            <button class="glass-btn active" onclick="switchView('cpm', this)">CPM 2025</button>
            <button class="glass-btn" onclick="switchView('swot', this)">SWOT 2026</button>
            <button class="glass-btn" onclick="switchView('ap', this)">AP 2026</button>
        </nav>
    </div>

    <div class="container">
        
        <!-- VIEW 1: BSC & PERFORMANCE INSIGHTS -->
        <div id="view-bsc" class="view-section">
            <h2 style="font-family:'Playfair Display'; margin-bottom:10px;">Balance Scorecard Overview</h2>
            <div class="grid-bsc">
                <div class="bsc-card" style="border-top-color: var(--vc-coral);" onclick="openBSC('financial')">
                    <div class="bsc-label">Financial</div>
                    <div class="bsc-val" style="color: var(--vc-coral);">50%</div>
                    <div class="bsc-sub">Weight: 5%  Critical</div>
                </div>
                <div class="bsc-card" style="border-top-color: var(--vc-blue);" onclick="openBSC('customer')">
                    <div class="bsc-label">Customer</div>
                    <div class="bsc-val" style="color: var(--vc-blue);">84%</div>
                    <div class="bsc-sub">Weight: 10%  Production OK</div>
                </div>
                <div class="bsc-card" style="border-top-color: var(--vc-teal);" onclick="openBSC('process')">
                    <div class="bsc-label">Internal Process</div>
                    <div class="bsc-val" style="color: var(--vc-teal);">90%</div>
                    <div class="bsc-sub">Weight: 40%  High Performance</div>
                </div>
                <div class="bsc-card" style="border-top-color: var(--vc-gold);" onclick="openBSC('growth')">
                    <div class="bsc-label">Growth</div>
                    <div class="bsc-val" style="color: var(--vc-gold);">82%</div>
                    <div class="bsc-sub">Weight: 45%  Competency High</div>
                </div>
            </div>

            <h3 style="margin-top:40px; border-bottom:1px solid #333; padding-bottom:10px;">Process Owner Deep Analysis (4 Perspectives)</h3>
            <div class="insight-grid">
                <div class="insight-box da-fin">
                    <div class="insight-header"><i class="fas fa-coins insight-icon"></i><div class="insight-title">Financial Perspective</div></div>
                    <div class="deep-analysis-item"><span class="da-title">Fenomena "Bleeding Cost"</span><div class="da-body">EBITDA &amp; Net Profit konsisten merah. Masalah utama pada <strong>Cost OB ($/Bcm)</strong> yang tidak terkontrol.</div><div class="da-root">Jarak angkut jauh (7km) + Beban Fixed Cost unit standby.</div></div>
                </div>
                <div class="insight-box da-cust">
                    <div class="insight-header"><i class="fas fa-users insight-icon" style="color: var(--vc-blue);"></i><div class="insight-title">Customer Perspective</div></div>
                    <div class="deep-analysis-item"><span class="da-title">Paradoks Kualitas</span><div class="da-body">Tonase tercapai (Hijau), tapi <strong>Customer Satisfaction</strong> jeblok (Merah 66%).</div><div class="da-root">Isu kualitas produk atau respon lambat terhadap keluhan.</div></div>
                </div>
                <div class="insight-box da-proc">
                    <div class="insight-header"><i class="fas fa-cogs insight-icon" style="color: var(--vc-teal);"></i><div class="insight-title">Internal Process</div></div>
                    <div class="deep-analysis-item"><span class="da-title">Inefisiensi Supply Chain</span><div class="da-body">ITO rendah. SOH Logistik membengkak hingga 35M (vs Budget 5M).</div><div class="da-root">Deadstock parts unit lama yang belum didisposal.</div></div>
                </div>
                <div class="insight-box da-grow">
                    <div class="insight-header"><i class="fas fa-seedling insight-icon" style="color: var(--vc-gold);"></i><div class="insight-title">Learning &amp; Growth</div></div>
                    <div class="deep-analysis-item"><span class="da-title">Kesenjangan Eksekusi</span><div class="da-body">Kompetensi tinggi, namun <strong>SME</strong> sangat rendah.</div><div class="da-root">Kegagalan konversi skill individu menjadi pencapaian korporat.</div></div>
                </div>
            </div>
        </div>

        <!-- VIEW 2: CPM 2025 (Corporate Performance Management) -->
        <div id="view-cpm" class="view-section active-view">
            <h2 style="font-family:'Playfair Display'; margin-bottom:20px; text-align:center;">CPM 2025: Operational Performance (Jan-Oct)</h2>
            <div class="cpm-wrapper">
                <table class="cpm-table" id="cpmTable"><thead><tr><th class="cpm-col-sticky" rowspan="2" style="z-index:30">OBJECTIVE</th><th class="cpm-col-sticky" style="left:200px; z-index:30" rowspan="2">UOM</th><th colspan="3">JAN</th><th colspan="3">FEB</th><th colspan="3">MAR</th><th colspan="3">APR</th><th colspan="3">MAY</th><th colspan="3">JUN</th><th colspan="3">JUL</th><th colspan="3">AUG</th><th colspan="3">SEP</th><th colspan="3">OCT</th></tr><tr><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th><th>PLAN</th><th>ACT</th><th>%</th></tr></thead><tbody><tr class="section-row"><td colspan="32">MAIN PRODUCTION</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">OB PRODUCTION</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm</td><td>1312k</td><td>1153k</td><td class="val-bad">88%</td><td>1416k</td><td>1175k</td><td class="val-bad">83%</td><td>888k</td><td>929k</td><td class="val-good">105%</td><td>913k</td><td>827k</td><td class="val-bad">91%</td><td>1015k</td><td>1092k</td><td class="val-good">108%</td><td>1006k</td><td>843k</td><td class="val-bad">84%</td><td>1138k</td><td>1214k</td><td class="val-good">107%</td><td>1097k</td><td>1054k</td><td class="val-good">96%</td><td>923k</td><td>684k</td><td class="val-bad">74%</td><td>962k</td><td>696k</td><td class="val-bad">72%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">COAL PRODUCTION</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ton</td><td>189k</td><td>229k</td><td class="val-good">122%</td><td>226k</td><td>252k</td><td class="val-good">112%</td><td>204k</td><td>201k</td><td class="val-good">98%</td><td>272k</td><td>183k</td><td class="val-bad">67%</td><td>315k</td><td>262k</td><td class="val-bad">83%</td><td>263k</td><td>194k</td><td class="val-bad">74%</td><td>293k</td><td>216k</td><td class="val-bad">74%</td><td>228k</td><td>138k</td><td class="val-bad">60%</td><td>204k</td><td>234k</td><td class="val-good">115%</td><td>212k</td><td>209k</td><td class="val-good">99%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">STRIPPING RATIO</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ratio</td><td>6.95</td><td>5.02</td><td class="val-good">72%</td><td>6.26</td><td>4.65</td><td class="val-good">74%</td><td>4.35</td><td>4.63</td><td class="val-bad">106%</td><td>3.36</td><td>4.51</td><td class="val-bad">134%</td><td>3.23</td><td>4.18</td><td class="val-bad">129%</td><td>3.82</td><td>4.35</td><td class="val-bad">114%</td><td>3.89</td><td>5.63</td><td class="val-bad">145%</td><td>4.82</td><td>7.67</td><td class="val-bad">159%</td><td>4.54</td><td>2.92</td><td class="val-good">64%</td><td>4.54</td><td>3.33</td><td class="val-good">73%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">COAL (in BCM)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm</td><td>150k</td><td>182k</td><td class="val-good">122%</td><td>179k</td><td>200k</td><td class="val-good">112%</td><td>162k</td><td>159k</td><td class="val-good">98%</td><td>216k</td><td>146k</td><td class="val-bad">67%</td><td>250k</td><td>208k</td><td class="val-bad">83%</td><td>209k</td><td>154k</td><td class="val-bad">74%</td><td>232k</td><td>171k</td><td class="val-bad">74%</td><td>181k</td><td>109k</td><td class="val-bad">60%</td><td>162k</td><td>186k</td><td class="val-good">115%</td><td>168k</td><td>166k</td><td class="val-good">99%</td></tr><tr class="section-row"><td colspan="32">DISTANCE</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">JARAK OB</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Meter</td><td>2k</td><td>2k</td><td class="val-good">96%</td><td>2k</td><td>2k</td><td class="val-good">103%</td><td>2k</td><td>2k</td><td class="val-bad">90%</td><td>3k</td><td>2k</td><td class="val-bad">83%</td><td>3k</td><td>3k</td><td class="val-good">99%</td><td>2k</td><td>2k</td><td class="val-good">104%</td><td>2k</td><td>2k</td><td class="val-bad">89%</td><td>2k</td><td>2k</td><td class="val-good">124%</td><td>2k</td><td>2k</td><td class="val-good">102%</td><td>2k</td><td>2k</td><td class="val-good">97%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">JARAK CO</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Meter</td><td>5k</td><td>4k</td><td class="val-bad">87%</td><td>5k</td><td>4k</td><td class="val-bad">81%</td><td>5k</td><td>5k</td><td class="val-bad">83%</td><td>5k</td><td>6k</td><td class="val-good">105%</td><td>5k</td><td>6k</td><td class="val-good">109%</td><td>5k</td><td>4k</td><td class="val-bad">80%</td><td>5k</td><td>5k</td><td class="val-bad">89%</td><td>5k</td><td>5k</td><td class="val-bad">87%</td><td>5k</td><td>5k</td><td class="val-bad">87%</td><td>5k</td><td>5k</td><td class="val-bad">87%</td></tr><tr class="section-row"><td colspan="32">PRODUCTIVITY LOADER</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">PC1250 (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/Jam</td><td>600</td><td>481</td><td class="val-bad">80%</td><td>600</td><td>503</td><td class="val-bad">84%</td><td>600</td><td>503</td><td class="val-bad">84%</td><td>600</td><td>528</td><td class="val-bad">88%</td><td>600</td><td>570</td><td class="val-good">95%</td><td>600</td><td>585</td><td class="val-good">98%</td><td>620</td><td>582</td><td class="val-bad">94%</td><td>620</td><td>586</td><td class="val-good">95%</td><td>620</td><td>590</td><td class="val-good">95%</td><td>620</td><td>550</td><td class="val-bad">89%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">PC1250 (MUD)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/Jam</td><td>250</td><td>0</td><td class="val-bad">0%%</td><td>250</td><td>0</td><td class="val-bad">0%%</td><td>250</td><td>216</td><td class="val-bad">86%</td><td>250</td><td>255</td><td class="val-good">102%</td><td>250</td><td>299</td><td class="val-good">120%</td><td>250</td><td>0</td><td class="val-bad">0%%</td><td>250</td><td>0</td><td class="val-bad">0%%</td><td>250</td><td>0</td><td class="val-bad">0%%</td><td>250</td><td>0</td><td class="val-bad">0%%</td><td>250</td><td>0</td><td class="val-bad">0%%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">PC850-SE (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/Jam</td><td>480</td><td>346</td><td class="val-bad">72%</td><td>480</td><td>275</td><td class="val-bad">57%</td><td>480</td><td>271</td><td class="val-bad">56%</td><td>480</td><td>328</td><td class="val-bad">68%</td><td>480</td><td>392</td><td class="val-bad">82%</td><td>480</td><td>0</td><td class="val-bad">0%%</td><td>480</td><td>0</td><td class="val-bad">0%%</td><td>480</td><td>0</td><td class="val-bad">0%%</td><td>480</td><td>0</td><td class="val-bad">0%%</td><td>480</td><td>0</td><td class="val-bad">0%%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">PC850-SE (MUD)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/Jam</td><td>250</td><td>198</td><td class="val-bad">79%</td><td>250</td><td>275</td><td class="val-good">110%</td><td>250</td><td>178</td><td class="val-bad">71%</td><td>250</td><td>190</td><td class="val-bad">76%</td><td>250</td><td>246</td><td class="val-good">98%</td><td>250</td><td>250</td><td class="val-good">100%</td><td>250</td><td>250</td><td class="val-good">100%</td><td>250</td><td>250</td><td class="val-good">100%</td><td>250</td><td>260</td><td class="val-good">104%</td><td>250</td><td>260</td><td class="val-good">104%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">E6550F (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/Jam</td><td>250</td><td>271</td><td class="val-good">108%</td><td>250</td><td>268</td><td class="val-good">107%</td><td>250</td><td>231</td><td class="val-bad">92%</td><td>250</td><td>276</td><td class="val-good">110%</td><td>250</td><td>305</td><td class="val-good">122%</td><td>250</td><td>302</td><td class="val-good">121%</td><td>250</td><td>309</td><td class="val-good">124%</td><td>250</td><td>313</td><td class="val-good">125%</td><td>250</td><td>310</td><td class="val-good">124%</td><td>250</td><td>300</td><td class="val-good">120%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">E6550F (MUD)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/Jam</td><td>170</td><td>198</td><td class="val-good">116%</td><td>170</td><td>0</td><td class="val-bad">0%%</td><td>170</td><td>149</td><td class="val-bad">88%</td><td>170</td><td>191</td><td class="val-good">112%</td><td>170</td><td>302</td><td class="val-good">178%</td><td>170</td><td>170</td><td class="val-good">100%</td><td>170</td><td>184</td><td class="val-good">108%</td><td>170</td><td>198</td><td class="val-good">116%</td><td>170</td><td>190</td><td class="val-good">112%</td><td>170</td><td>190</td><td class="val-good">112%</td></tr><tr class="section-row"><td colspan="32">PRODUCTIVITY COAL</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">PC500 (CO)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ton/Jam</td><td>200</td><td>184</td><td class="val-bad">92%</td><td>200</td><td>217</td><td class="val-good">109%</td><td>200</td><td>189</td><td class="val-good">95%</td><td>200</td><td>182</td><td class="val-bad">91%</td><td>200</td><td>196</td><td class="val-good">98%</td><td>200</td><td>189</td><td class="val-good">95%</td><td>200</td><td>168</td><td class="val-bad">84%</td><td>200</td><td>191</td><td class="val-good">96%</td><td>200</td><td>190</td><td class="val-good">95%</td><td>200</td><td>195</td><td class="val-good">98%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">E6550F (CO)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ton/Jam</td><td>200</td><td>176</td><td class="val-bad">88%</td><td>200</td><td>204</td><td class="val-good">102%</td><td>200</td><td>195</td><td class="val-good">98%</td><td>200</td><td>190</td><td class="val-good">95%</td><td>200</td><td>203</td><td class="val-good">101%</td><td>200</td><td>179</td><td class="val-bad">90%</td><td>200</td><td>170</td><td class="val-bad">85%</td><td>200</td><td>195</td><td class="val-good">98%</td><td>200</td><td>185</td><td class="val-bad">93%</td><td>200</td><td>180</td><td class="val-bad">90%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">ZX350 (CO)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ton/Jam</td><td>170</td><td>126</td><td class="val-bad">74%</td><td>170</td><td>124</td><td class="val-bad">73%</td><td>170</td><td>121</td><td class="val-bad">71%</td><td>170</td><td>125</td><td class="val-bad">74%</td><td>170</td><td>128</td><td class="val-bad">75%</td><td>170</td><td>126</td><td class="val-bad">74%</td><td>170</td><td>118</td><td class="val-bad">69%</td><td>170</td><td>136</td><td class="val-bad">80%</td><td>170</td><td>130</td><td class="val-bad">76%</td><td>170</td><td>135</td><td class="val-bad">79%</td></tr><tr class="section-row"><td colspan="32">PRODUCTIVITY HAULER</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">HD785 (PC-1250) (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/km</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td><td>117</td><td>0</td><td class="val-bad">0%%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">CMT106 (PC-1250) (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/km</td><td>140</td><td>104</td><td class="val-bad">74%</td><td>140</td><td>104</td><td class="val-bad">74%</td><td>140</td><td>99</td><td class="val-bad">71%</td><td>140</td><td>101</td><td class="val-bad">72%</td><td>140</td><td>123</td><td class="val-bad">88%</td><td>140</td><td>124</td><td class="val-bad">89%</td><td>140</td><td>124</td><td class="val-bad">89%</td><td>140</td><td>135</td><td class="val-good">96%</td><td>140</td><td>138</td><td class="val-good">99%</td><td>140</td><td>130</td><td class="val-bad">93%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">CMT106 (PC-1250) (Mud)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/km</td><td>90</td><td>0</td><td class="val-bad">0%%</td><td>90</td><td>0</td><td class="val-bad">0%%</td><td>90</td><td>64</td><td class="val-bad">71%</td><td>90</td><td>58</td><td class="val-bad">64%</td><td>90</td><td>67</td><td class="val-bad">74%</td><td>90</td><td>0</td><td class="val-bad">0%%</td><td>90</td><td>0</td><td class="val-bad">0%%</td><td>90</td><td>0</td><td class="val-bad">0%%</td><td>90</td><td>0</td><td class="val-bad">0%%</td><td>90</td><td>0</td><td class="val-bad">0%%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">T106 (ZX870) (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/km</td><td>130</td><td>82</td><td class="val-bad">63%</td><td>130</td><td>85</td><td class="val-bad">65%</td><td>130</td><td>84</td><td class="val-bad">65%</td><td>130</td><td>68</td><td class="val-bad">52%</td><td>130</td><td>118</td><td class="val-bad">91%</td><td>130</td><td>130</td><td class="val-good">100%</td><td>130</td><td>112</td><td class="val-bad">86%</td><td>130</td><td>120</td><td class="val-bad">92%</td><td>130</td><td>125</td><td class="val-good">96%</td><td>130</td><td>128</td><td class="val-good">98%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">T106 (ZX470) (OB)</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Bcm/km</td><td>111</td><td>79</td><td class="val-bad">71%</td><td>111</td><td>80</td><td class="val-bad">72%</td><td>111</td><td>88</td><td class="val-bad">79%</td><td>111</td><td>89</td><td class="val-bad">80%</td><td>111</td><td>104</td><td class="val-bad">94%</td><td>111</td><td>105</td><td class="val-good">95%</td><td>111</td><td>110</td><td class="val-good">99%</td><td>111</td><td>117</td><td class="val-good">105%</td><td>111</td><td>115</td><td class="val-good">104%</td><td>111</td><td>112</td><td class="val-good">101%</td></tr><tr class="section-row"><td colspan="32">KPI LAINNYA</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">EWH</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Jam/Hari</td><td>15.3</td><td>11.5</td><td class="val-bad">75%</td><td>15.3</td><td>12.5</td><td class="val-bad">82%</td><td>16.5</td><td>12.6</td><td class="val-bad">76%</td><td>17.6</td><td>11.1</td><td class="val-bad">63%</td><td>18</td><td>12.4</td><td class="val-bad">69%</td><td>18.8</td><td>12.7</td><td class="val-bad">68%</td><td>18.6</td><td>15.6</td><td class="val-bad">84%</td><td>18.6</td><td>18.6</td><td class="val-good">100%</td><td>18.5</td><td>17.5</td><td class="val-good">95%</td><td>18.5</td><td>17</td><td class="val-bad">92%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">UA</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">%</td><td>65</td><td>90</td><td class="val-good">138%</td><td>65</td><td>89</td><td class="val-good">137%</td><td>65</td><td>61</td><td class="val-bad">94%</td><td>65</td><td>74</td><td class="val-good">114%</td><td>65</td><td>65</td><td class="val-good">100%</td><td>65</td><td>148</td><td class="val-good">228%</td><td>65</td><td>172</td><td class="val-good">265%</td><td>65</td><td>152</td><td class="val-good">234%</td><td>65</td><td>77</td><td class="val-good">118%</td><td>65</td><td>135</td><td class="val-good">208%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">PA</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">%</td><td>92</td><td>94</td><td class="val-good">102%</td><td>92</td><td>97</td><td class="val-good">105%</td><td>92</td><td>105</td><td class="val-good">114%</td><td>92</td><td>97</td><td class="val-good">105%</td><td>92</td><td>95</td><td class="val-good">103%</td><td>92</td><td>95</td><td class="val-good">103%</td><td>92</td><td>94</td><td class="val-good">102%</td><td>92</td><td>92</td><td class="val-good">100%</td><td>92</td><td>100</td><td class="val-good">109%</td><td>92</td><td>98</td><td class="val-good">107%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">GA</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">%</td><td>85</td><td>88</td><td class="val-good">104%</td><td>85</td><td>87</td><td class="val-good">102%</td><td>85</td><td>85</td><td class="val-good">100%</td><td>85</td><td>84</td><td class="val-good">99%</td><td>85</td><td>86</td><td class="val-good">101%</td><td>85</td><td>88</td><td class="val-good">104%</td><td>85</td><td>89</td><td class="val-good">105%</td><td>85</td><td>87</td><td class="val-good">102%</td><td>85</td><td>88</td><td class="val-good">104%</td><td>85</td><td>88</td><td class="val-good">104%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">FUEL FACTOR</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">L/Bcm</td><td>0.65</td><td>0.68</td><td class="val-bad">105%</td><td>0.65</td><td>0.72</td><td class="val-bad">111%</td><td>0.65</td><td>0.69</td><td class="val-bad">106%</td><td>0.65</td><td>0.64</td><td class="val-good">98%</td><td>0.65</td><td>0.63</td><td class="val-good">97%</td><td>0.65</td><td>0.62</td><td class="val-good">95%</td><td>0.65</td><td>0.66</td><td class="val-bad">102%</td><td>0.65</td><td>0.7</td><td class="val-bad">108%</td><td>0.65</td><td>0.68</td><td class="val-bad">105%</td><td>0.65</td><td>0.67</td><td class="val-bad">103%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">FUEL RATIO</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">L/Ton</td><td>2.5</td><td>2.8</td><td class="val-bad">112%</td><td>2.5</td><td>2.9</td><td class="val-bad">116%</td><td>2.5</td><td>2.7</td><td class="val-bad">108%</td><td>2.5</td><td>2.6</td><td class="val-bad">104%</td><td>2.5</td><td>2.4</td><td class="val-good">96%</td><td>2.5</td><td>2.5</td><td class="val-good">100%</td><td>2.5</td><td>2.6</td><td class="val-bad">104%</td><td>2.5</td><td>2.8</td><td class="val-bad">112%</td><td>2.5</td><td>2.7</td><td class="val-bad">108%</td><td>2.5</td><td>2.7</td><td class="val-bad">108%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">MANPOWER RATIO</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ratio</td><td>14</td><td>13.3</td><td class="val-good">95%</td><td>14</td><td>13.1</td><td class="val-good">94%</td><td>14</td><td>14.5</td><td class="val-bad">104%</td><td>14</td><td>14</td><td class="val-good">100%</td><td>14</td><td>15</td><td class="val-bad">107%</td><td>14</td><td>14</td><td class="val-good">100%</td><td>14</td><td>16</td><td class="val-bad">114%</td><td>14</td><td>14</td><td class="val-good">100%</td><td>14</td><td>15</td><td class="val-bad">107%</td><td>14</td><td>14</td><td class="val-good">100%</td></tr><tr>
                    <td class="cpm-col-sticky kpi-row-header">RATIO OP : PENGAWAS</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">Ratio</td><td>14</td><td>13.6</td><td class="val-good">97%</td><td>14</td><td>14.6</td><td class="val-bad">104%</td><td>14</td><td>15.6</td><td class="val-bad">111%</td><td>14</td><td>14.3</td><td class="val-bad">102%</td><td>14</td><td>15</td><td class="val-bad">107%</td><td>14</td><td>14</td><td class="val-good">100%</td><td>14</td><td>14.8</td><td class="val-bad">106%</td><td>14</td><td>15</td><td class="val-bad">107%</td><td>14</td><td>14.5</td><td class="val-bad">104%</td><td>14</td><td>14.2</td><td class="val-bad">101%</td></tr></tbody></table>
            </div>
        </div>

        <!-- VIEW 3: SWOT MATRIX -->
        <div id="view-swot" class="view-section">
            <h2 style="font-family:'Playfair Display'; margin-bottom:20px; text-align:center;">Strategic TOWS Matrix 2026</h2>
            <div class="matrix-container">
                <div class="m-box legend-box"><div class="legend-title">TOWS</div></div>
                <div class="m-box border-teal" onclick="openModal('strength')"><div class="box-header text-teal">INTERNAL FACTOR</div><div class="box-title">STRENGTHS (S)</div><ul class="box-list"><li><i class="fas fa-truck-monster"></i> Asset Standby Available</li><li><i class="fas fa-industry"></i> IPMS Plant Achv 98%</li><li><i class="fas fa-tools"></i> Dedicated Workshop Comex</li><li><i class="fas fa-users-cog"></i> Versatility Operator</li></ul></div>
                <div class="m-box border-coral" onclick="openModal('weakness')"><div class="box-header text-coral">INTERNAL FACTOR</div><div class="box-title">WEAKNESSES (W)</div><ul class="box-list"><li><i class="fas fa-road"></i> Jarak Logistik 7km</li><li><i class="fas fa-boxes"></i> SOH Logistik 35M vs 5M</li><li><i class="fas fa-exclamation-triangle"></i> Area Undercut HW Pit Warutas</li><li><i class="fas fa-tachometer-alt"></i> Rasio Mekanik Tidak Standar</li></ul></div>
                <div class="m-box border-gold axis-box" onclick="openModal('opportunity')"><div class="box-header text-gold">EXTERNAL FACTOR</div><div class="box-title">OPPORTUNITIES (O)</div><ul class="box-list"><li><i class="fas fa-map-marked-alt"></i> Jarak tambang dekat</li><li><i class="fas fa-money-bill-wave"></i> Finalisasi Disposal Top Soil</li><li><i class="fas fa-users"></i> Sumber daya berlimpah</li><li><i class="fas fa-route"></i> AWR Jalan Hauling Siap</li></ul></div>
                <div class="m-box strat-box" onclick="openModal('so')"><div class="strat-indicator">SO</div><div class="box-header text-teal">STRATEGY</div><div class="box-title">AGGRESSIVE</div><ul class="box-list"><li><i class="fas fa-gas-pump"></i> Kurangi Bus (Fuel Saving)</li><li><i class="fas fa-plus-circle"></i> Vol diluar JSO</li><li><i class="fas fa-fast-forward"></i> Percepatan Slippery OB</li></ul></div>
                <div class="m-box strat-box" onclick="openModal('wo')"><div class="strat-indicator">WO</div><div class="box-header text-gold">STRATEGY</div><div class="box-title">TURNAROUND</div><ul class="box-list"><li><i class="fas fa-shield-alt"></i> Pengamanan Aset (CCTV)</li><li><i class="fas fa-hourglass-end"></i> STO Mine Closure</li><li><i class="fas fa-network-wired"></i> Fiber Optic Install</li></ul></div>
                <div class="m-box border-coral axis-box" style="border-left: 4px solid var(--vc-coral);" onclick="openModal('threat')"><div class="box-header text-coral">EXTERNAL FACTOR</div><div class="box-title">THREATS (T)</div><ul class="box-list"><li><i class="fas fa-chart-line-down"></i> Penurunan volume 2026</li><li><i class="fas fa-filter"></i> Crusher Penuh (KPP)</li><li><i class="fas fa-fire-alt"></i> StockROM Temporary SponCom</li><li><i class="fas fa-water"></i> Sedimentasi Lumpur</li></ul></div>
                <div class="m-box strat-box" onclick="openModal('st')"><div class="strat-indicator">ST</div><div class="box-header text-blue">STRATEGY</div><div class="box-title">DIVERSIFICATION</div><ul class="box-list"><li><i class="fas fa-warehouse"></i> Infra Pit Stop Warutas</li><li><i class="fas fa-piggy-bank"></i> Budget Ops Efficiency</li><li><i class="fas fa-drafting-compass"></i> Rekayasa Lumpur</li></ul></div>
                <div class="m-box strat-box" onclick="openModal('wt')"><div class="strat-indicator">WT</div><div class="box-header text-coral">STRATEGY</div><div class="box-title">DEFENSIVE</div><ul class="box-list"><li><i class="fas fa-compress-arrows-alt"></i> Kurangi Vol Design 2026</li><li><i class="fas fa-user-shield"></i> Pagar Aset IT</li><li><i class="fas fa-dolly"></i> Transfer Deadstock</li></ul></div>
            </div>
        </div>

        <!-- VIEW 4: AP 2026 -->
        <div id="view-ap" class="view-section">
             <div style="text-align:center; padding: 100px; color: #555;">
                 <i class="fas fa-tasks" style="font-size: 50px; margin-bottom: 20px;"></i>
                 <h2 style="font-family:'Playfair Display';">Action Plan 2026</h2>
                 <p>Module Ready for Implementation</p>
             </div>
        </div>

    </div>

    <!-- POPUP WINDOW -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-window">
            <div class="mw-header">
                <div class="mw-title" id="mTitle">FINANCIAL</div>
                <button class="mw-close" onclick="closeModal()"></button>
            </div>
            <div class="mw-body" id="mBody"><div class="kpi-grid"><div class="kpi-card"><div class="kpi-title" title="REVENUE">REVENUE</div><div class="ytd-badge ytd-bad">Avg Achv: 90%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">68%</div></div><div class="mini-chart-container"><canvas id="miniChart-0" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="EBITDA">EBITDA</div><div class="ytd-badge ytd-bad">Avg Achv: 4%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">-5%</div></div><div class="mini-chart-container"><canvas id="miniChart-1" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="EBT">EBT</div><div class="ytd-badge ytd-bad">Avg Achv: -65%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">-85%</div></div><div class="mini-chart-container"><canvas id="miniChart-2" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="EAT">EAT</div><div class="ytd-badge ytd-bad">Avg Achv: -80%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">-110%</div></div><div class="mini-chart-container"><canvas id="miniChart-3" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="COST OB">COST OB</div><div class="ytd-badge ytd-bad">Avg Achv: 55%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">0%</div></div><div class="mini-chart-container"><canvas id="miniChart-4" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="COST CO">COST CO</div><div class="ytd-badge ytd-bad">Avg Achv: 41%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">0%</div></div><div class="mini-chart-container"><canvas id="miniChart-5" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="CASH FLOW">CASH FLOW</div><div class="ytd-badge ytd-good">Avg Achv: 145%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#d63031">120%</div></div><div class="mini-chart-container"><canvas id="miniChart-6" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div><div class="kpi-card"><div class="kpi-title" title="TAX ACCURACY">TAX ACCURACY</div><div class="ytd-badge ytd-bad">Avg Achv: 0%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:#27ae60">-</div></div><div class="mini-chart-container"><canvas id="miniChart-7" width="401" height="225" style="display: block; box-sizing: border-box; height: 180px; width: 320.8px;"></canvas></div></div></div></div>
        </div>
    </div>

    <script>
        function switchView(viewId, btn) {
            document.querySelectorAll('.glass-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.querySelectorAll('.view-section').forEach(section => {
                section.classList.remove('active-view');
            });
            document.getElementById('view-' + viewId).classList.add('active-view');
        }

        // --- EXTENDED CPM DATA CONSTRUCTION ---
        // Includes detailed data from the CSV file structure
        const cpmFullData = [
            // MAIN PRODUCTION
            { category: "MAIN PRODUCTION", kpi: "OB PRODUCTION", uom: "Bcm", plan: [1311959, 1416366, 887878, 912821, 1014757, 1006123, 1137902, 1096959, 923387, 961589], act: [1153100, 1174643, 929329, 827097, 1092453, 843253, 1213916, 1054322, 684223, 695701] },
            { category: "MAIN PRODUCTION", kpi: "COAL PRODUCTION", uom: "Ton", plan: [188739, 226110, 204172, 271992, 314590, 263217, 292524, 227757, 203506, 211721], act: [229483, 252469, 200712, 183348, 261533, 193890, 215732, 137543, 233978, 209099] },
            { category: "MAIN PRODUCTION", kpi: "STRIPPING RATIO", uom: "Ratio", plan: [6.95, 6.26, 4.35, 3.36, 3.23, 3.82, 3.89, 4.82, 4.54, 4.54], act: [5.02, 4.65, 4.63, 4.51, 4.18, 4.35, 5.63, 7.67, 2.92, 3.33] },
            { category: "MAIN PRODUCTION", kpi: "COAL (in BCM)", uom: "Bcm", plan: [149793, 179453, 162041, 215866, 249675, 208902, 232162, 180760, 161513, 168032], act: [182129, 200372, 159295, 145514, 207566, 153881, 171216, 109161, 185697, 165952] },
            { category: "DISTANCE", kpi: "JARAK OB", uom: "Meter", plan: [2186, 2047, 2431, 2630, 2687, 2268, 2226, 1964, 1863, 1856], act: [2095, 2101, 2193, 2195, 2648, 2369, 1985, 2434, 1900, 1800] },
            { category: "DISTANCE", kpi: "JARAK CO", uom: "Meter", plan: [4893, 4931, 5432, 5429, 5310, 5284, 5175, 5279, 5300, 5300], act: [4277, 4005, 4507, 5700, 5796, 4219, 4581, 4583, 4600, 4600] },
            
            // OPERATIONAL EXCELLENT - PRODUCTIVITY
            { category: "PRODUCTIVITY LOADER", kpi: "PC1250 (OB)", uom: "Bcm/Jam", plan: [600, 600, 600, 600, 600, 600, 620, 620, 620, 620], act: [481, 503, 503, 528, 570, 585, 582, 586, 590, 550] },
            { category: "PRODUCTIVITY LOADER", kpi: "PC1250 (MUD)", uom: "Bcm/Jam", plan: [250, 250, 250, 250, 250, 250, 250, 250, 250, 250], act: [0, 0, 216, 255, 299, 0, 0, 0, 0, 0] },
            { category: "PRODUCTIVITY LOADER", kpi: "PC850-SE (OB)", uom: "Bcm/Jam", plan: [480, 480, 480, 480, 480, 480, 480, 480, 480, 480], act: [346, 275, 271, 328, 392, 0, 0, 0, 0, 0] },
            { category: "PRODUCTIVITY LOADER", kpi: "PC850-SE (MUD)", uom: "Bcm/Jam", plan: [250, 250, 250, 250, 250, 250, 250, 250, 250, 250], act: [198, 275, 178, 190, 246, 250, 250, 250, 260, 260] },
            { category: "PRODUCTIVITY LOADER", kpi: "E6550F (OB)", uom: "Bcm/Jam", plan: [250, 250, 250, 250, 250, 250, 250, 250, 250, 250], act: [271, 268, 231, 276, 305, 302, 309, 313, 310, 300] },
            { category: "PRODUCTIVITY LOADER", kpi: "E6550F (MUD)", uom: "Bcm/Jam", plan: [170, 170, 170, 170, 170, 170, 170, 170, 170, 170], act: [198, 0, 149, 191, 302, 170, 184, 198, 190, 190] },
            
            { category: "PRODUCTIVITY COAL", kpi: "PC500 (CO)", uom: "Ton/Jam", plan: [200, 200, 200, 200, 200, 200, 200, 200, 200, 200], act: [184, 217, 189, 182, 196, 189, 168, 191, 190, 195] },
            { category: "PRODUCTIVITY COAL", kpi: "E6550F (CO)", uom: "Ton/Jam", plan: [200, 200, 200, 200, 200, 200, 200, 200, 200, 200], act: [176, 204, 195, 190, 203, 179, 170, 195, 185, 180] },
            { category: "PRODUCTIVITY COAL", kpi: "ZX350 (CO)", uom: "Ton/Jam", plan: [170, 170, 170, 170, 170, 170, 170, 170, 170, 170], act: [126, 124, 121, 125, 128, 126, 118, 136, 130, 135] },
            
            { category: "PRODUCTIVITY HAULER", kpi: "HD785 (PC-1250) (OB)", uom: "Bcm/km", plan: [117, 117, 117, 117, 117, 117, 117, 117, 117, 117], act: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] }, 
            { category: "PRODUCTIVITY HAULER", kpi: "CMT106 (PC-1250) (OB)", uom: "Bcm/km", plan: [140, 140, 140, 140, 140, 140, 140, 140, 140, 140], act: [104, 104, 99, 101, 123, 124, 124, 135, 138, 130] },
            { category: "PRODUCTIVITY HAULER", kpi: "CMT106 (PC-1250) (Mud)", uom: "Bcm/km", plan: [90, 90, 90, 90, 90, 90, 90, 90, 90, 90], act: [0, 0, 64, 58, 67, 0, 0, 0, 0, 0] },
            { category: "PRODUCTIVITY HAULER", kpi: "T106 (ZX870) (OB)", uom: "Bcm/km", plan: [130, 130, 130, 130, 130, 130, 130, 130, 130, 130], act: [82, 85, 84, 68, 118, 130, 112, 120, 125, 128] },
            { category: "PRODUCTIVITY HAULER", kpi: "T106 (ZX470) (OB)", uom: "Bcm/km", plan: [111, 111, 111, 111, 111, 111, 111, 111, 111, 111], act: [79, 80, 88, 89, 104, 105, 110, 117, 115, 112] },
            
            { category: "KPI LAINNYA", kpi: "EWH", uom: "Jam/Hari", plan: [15.3, 15.3, 16.5, 17.6, 18.0, 18.8, 18.6, 18.6, 18.5, 18.5], act: [11.5, 12.5, 12.6, 11.1, 12.4, 12.7, 15.6, 18.6, 17.5, 17.0] },
            { category: "KPI LAINNYA", kpi: "UA", uom: "%", plan: [65, 65, 65, 65, 65, 65, 65, 65, 65, 65], act: [90, 89, 61, 74, 65, 148, 172, 152, 77, 135] },
            { category: "KPI LAINNYA", kpi: "PA", uom: "%", plan: [92, 92, 92, 92, 92, 92, 92, 92, 92, 92], act: [94, 97, 105, 97, 95, 95, 94, 92, 100, 98] },
            { category: "KPI LAINNYA", kpi: "GA", uom: "%", plan: [85, 85, 85, 85, 85, 85, 85, 85, 85, 85], act: [88, 87, 85, 84, 86, 88, 89, 87, 88, 88] },
            { category: "KPI LAINNYA", kpi: "FUEL FACTOR", uom: "L/Bcm", plan: [0.65, 0.65, 0.65, 0.65, 0.65, 0.65, 0.65, 0.65, 0.65, 0.65], act: [0.68, 0.72, 0.69, 0.64, 0.63, 0.62, 0.66, 0.70, 0.68, 0.67] },
            { category: "KPI LAINNYA", kpi: "FUEL RATIO", uom: "L/Ton", plan: [2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5], act: [2.8, 2.9, 2.7, 2.6, 2.4, 2.5, 2.6, 2.8, 2.7, 2.7] },
            { category: "KPI LAINNYA", kpi: "MANPOWER RATIO", uom: "Ratio", plan: [14, 14, 14, 14, 14, 14, 14, 14, 14, 14], act: [13.3, 13.1, 14.5, 14, 15, 14, 16, 14, 15, 14] },
            { category: "KPI LAINNYA", kpi: "RATIO OP : PENGAWAS", uom: "Ratio", plan: [14, 14, 14, 14, 14, 14, 14, 14, 14, 14], act: [13.6, 14.6, 15.6, 14.3, 15, 14, 14.8, 15, 14.5, 14.2] }
        ];

        // Months Array
        const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT"];

        function renderCPMTable() {
            const table = document.getElementById('cpmTable');
            
            // 1. Build Header
            let headerHTML = `<thead><tr><th class="cpm-col-sticky" rowspan="2" style="z-index:30">OBJECTIVE</th><th class="cpm-col-sticky" style="left:200px; z-index:30" rowspan="2">UOM</th>`;
            months.forEach(m => {
                headerHTML += `<th colspan="3">${m}</th>`;
            });
            headerHTML += `</tr><tr>`;
            months.forEach(m => {
                headerHTML += `<th>PLAN</th><th>ACT</th><th>%</th>`;
            });
            headerHTML += `</tr></thead><tbody>`;

            // 2. Build Body
            let currentCat = "";
            cpmFullData.forEach(row => {
                // Add Category Header if changed
                if (row.category !== currentCat) {
                    headerHTML += `<tr class="section-row"><td colspan="${2 + (months.length*3)}">${row.category}</td></tr>`;
                    currentCat = row.category;
                }

                headerHTML += `<tr>
                    <td class="cpm-col-sticky kpi-row-header">${row.kpi}</td>
                    <td class="cpm-col-sticky uom-col" style="left:200px">${row.uom}</td>`;
                
                for (let i = 0; i < months.length; i++) {
                    const p = row.plan[i] || 0;
                    const a = row.act[i] || 0;
                    
                    let achv = 0;
                    if (p !== 0) achv = Math.round((a / p) * 100);
                    
                    // Formatting Numbers
                    let pDisp = p;
                    let aDisp = a;
                    if (p > 999) pDisp = (p/1000).toFixed(0) + 'k';
                    if (a > 999) aDisp = (a/1000).toFixed(0) + 'k';
                    
                    // Color Logic
                    let cls = 'val-neutral';
                    let isGood = achv >= 95;
                    
                    if (row.kpi.includes("FUEL") || row.kpi.includes("JARAK") || row.kpi.includes("RATIO")) {
                        // For Distance/Fuel/Ratio, usually lower or exact match is target
                        // If Fuel, Achv > 100 is Bad
                        if (row.kpi.includes("FUEL") || row.kpi.includes("RATIO")) isGood = achv <= 100;
                    }
                    
                    if (a === 0 && p === 0) {
                        achv = '-'; cls = '';
                    } else if (a === 0 && p !== 0) {
                        achv = '0%'; cls = 'val-bad';
                    } else {
                        cls = isGood ? 'val-good' : 'val-bad';
                    }

                    headerHTML += `<td>${pDisp}</td><td>${aDisp}</td><td class="${cls}">${achv}${achv !== '-' ? '%' : ''}</td>`;
                }
                headerHTML += `</tr>`;
            });

            headerHTML += `</tbody>`;
            table.innerHTML = headerHTML;
        }

        // --- RENDER CPM ON LOAD ---
        renderCPMTable();

        // [EXISTING CODE: swotData, bscData, kpiPlans, openModal, openBSC, switchView, etc. remains unchanged]
        // ... (Include previous JS logic here) ...
        const swotData = {
            strength: { 
                title: "STRENGTHS (S)", icon: "fas fa-dumbbell",
                items: [
                    { summary: "Banyak Asset Standby Terkait penyesuaian Produksi", details: ["Evidence: Unit Parkir di Yard", "Kondisi unit siap operasi jika diperlukan"] },
                    { summary: "Sikap Inisiatif All Departemen dalam aktivitas mobilisasi", details: ["Evidence: Meeting Koordinasi All Dept", "Kecepatan respon tim dalam situasi darurat"] },
                    { summary: "Pada Q1 2026 melakukan kegiatan Penambangan hanya pada Pit Warutas", details: ["Evidence: Mine Plan 2026", "Fokus pengawasan dan unit lebih terpusat"] },
                    { summary: "Adanya Dedicated Workshop Comex AGM", details: ["Evidence: Workshop Asset", "Mempercepat perbaikan komponen critical"] },
                    { summary: "Sudah terinstalnya Vita Universal Pada All Unit Hauler & Lora", details: ["Evidence: Unit Spec", "Monitoring fatigue dan produktivitas realtime"] },
                    { summary: "Versatility Operator (CMT backup Grader/Compact)", details: ["1. 2x Operator CMT dapat backup Grader", "2. 1x Operator Compact dapat backup Dozer", "Mengurangi dampak absensi operator"] },
                    { summary: "Metode Change Shift FIFO LIFO sudah Konsisten pada Fleet OB & Coal", details: ["Evidence: Timesheet", "Mengurangi loss time saat pergantian shift"] },
                    { summary: "Dedicated Vendor THM untuk Hose Fitting Brand China", details: ["Evidence: Vendor Contract", "Ketersediaan hose hydraulic lebih terjamin"] },
                    { summary: "Oktober-November Implementasi IPMS Plant AGM achv pada 98%", details: ["Evidence: Dashboard IPMS", "Kepatuhan maintenance schedule sangat tinggi"] }
                ] 
            },
            weakness: { 
                title: "WEAKNESSES (W)", icon: "fas fa-exclamation-triangle",
                items: [
                    { summary: "Jarak Infrastruktur Workshop Logistik ke Tambang Jauh (7 km)", details: ["Impact: Waktu tempuh breakdown unit lama", "Biaya fuel support vehicle tinggi"] },
                    { summary: "Posisi Aset serta Infrastruktur berjauhan menyulitkan pengamanan", details: ["Risk: Potensi pencurian komponen/BBM", "Memerlukan patroli ekstra"] },
                    { summary: "SOH Logistik Sangat Besar terhadap Target Produksi Berjalan", details: ["35 M vs Budget 5 M", "Cashflow tertahan di inventory deadstock"] },
                    { summary: "Adanya Area Undercut pada HW Pit Warutas", details: ["Risk: Geotek (Longsor)", "Menghambat sequence penambangan di bawahnya"] },
                    { summary: "Masih adanya carry over reklamasi dari bulan berjalan tahun 2025", details: ["Impact: Compliance isu lingkungan", "Menambah beban kerja di tahun berikutnya"] },
                    { summary: "Ketidaktercapaian JS vs TC selama tahun 2025 Achv 93%", details: ["Belum terpickupnya data survey karena area finalisasi terendam", "Adanya Carry back material Lengket", "Ketidakkonsistensi Sampling Uji Petik Sampling Vessel"] },
                    { summary: "Lebar Front Warutas Sempit karena Multi Seam", details: ["Achv Agustus-Oktober Plan 3 Actual 2.52", "Manuver alat terbatas, cycle time tinggi"] },
                    { summary: "Tidak Standarnya Perhitungan STD Rasio Mekanik", details: ["Track Plan 1.3 Actual 0.8", "Wheel Plan 0.9 Actual 0.7", "Supp Plan 0.8 Actual 0.4", "Beban kerja mekanik berlebih"] },
                    { summary: "Ketika Closing Project banyaknya Asset AGM untuk di Move", details: ["Cost: Biaya demobilisasi tinggi", "Memerlukan space parkir aman"] },
                    { summary: "Respon time perbaikan Unit Produksi, Jaringan & Perangkat IT potensi terhambat", details: ["Cakupan area kerja luas berbanding ketersediaan sarana", "Downtime sistem komunikasi"] },
                    { summary: "Perbandingan volume produksi dengan kompetitor sekitar AGM", details: ["Benchmarking menunjukkan kita tertinggal di aspek tertentu"] }
                ] 
            },
            opportunity: { 
                title: "OPPORTUNITIES (O)", icon: "fas fa-lightbulb",
                items: [
                    { summary: "Jarak tambang dengan Rumah karyawan lokal dominan dekat", details: ["Benefit: Fatigue Management lebih mudah", "Cost transport karyawan rendah"] },
                    { summary: "Ada nya kegiatan Finalisasi Disposal pekerjaan Top Soil sebagai project tambahan Revenue", details: ["Benefit: Income tambahan di luar core coal"] },
                    { summary: "Adanya Sumber daya berlimpah dari Warga Sekitar untuk Posisi Operator", details: ["Benefit: Kemudahan rekrutmen", "Mendukung program pemberdayaan lokal"] },
                    { summary: "Sudah di AWRnya Jalan Hauling AGM s.d Muara Pit Warutas", details: ["Benefit: Akses jalan segala cuaca", "Produktivitas hauling lebih stabil"] },
                    { summary: "Pembuatan StockRom temporary pada RL0, RL+55, RL+85", details: ["Benefit: Buffer stock saat hauling terhambat", "Menjaga kontinuitas feeding crusher"] },
                    { summary: "Penambahan Volume dari Project Reklamasi Total 120 Ha (2025 20 Ha)", details: ["Benefit: Revenue dari pekerjaan reklamasi"] }
                ] 
            },
            threat: { 
                title: "THREATS (T)", icon: "fas fa-bolt",
                items: [
                    { summary: "Adanya Penurunan volume di tahun 2026 dari 11,251,671.79 BCM ke 1,452,631 BCM", details: ["Risk: Revenue Drop signifikan", "Potensi kelebihan unit/manpower"] },
                    { summary: "Crusher sering penuh karena Prioritas mengeluarkan CG KPP", details: ["Risk: Delay Coal Getting", "Antrian unit hauling di hopper"] },
                    { summary: "StockROM Temporary memerlukan perawatan berupa pemadaman api dari SponCom", details: ["Risk: Safety (Kebakaran)", "Cost tambahan penanganan"] },
                    { summary: "Material Pit Mudah Membentuk sedimentasi Lumpur", details: ["Risk: Water Management isu", "Jalan tambang licin/rusak"] },
                    { summary: "Workshop KUD hanya boleh diaktifkan sebagai Pit Stop dengan Syarat di Cor (est 400 jt)", details: ["Cost: Investasi tambahan", "Izin lokasi"] },
                    { summary: "Pit Warutas bersampingan dengan sungai potensi limpasan tambang ke sungai", details: ["Risk: Environmental Compliance (Pencemaran)", "Stop operasi dari inspektur tambang"] },
                    { summary: "Potensi Loading Batubara dari StockROM Warute temporary ke Cruhser pada Q1 2026 sebesar 224.181 Ton", details: ["Opportunity/Challenge: Handling material rehandling"] },
                    { summary: "Potensi Pekerjaan General pada StockROM Warute pada Q1 2026", details: ["Additional Scope"] },
                    { summary: "Potensi Kehilangan/Kecurian Asset IT karena Lokasi dekat dengan akses Jalan Warga", details: ["Risk: Security", "Loss of Data/Asset"] },
                    { summary: "Potensi Adanya Cross Hauling pada Jalur simpang 4 Warutas dengan Hauling KPP", details: ["Risk: Traffic Accident", "Perlu traffic management ketat"] }
                ] 
            },
            so: { 
                title: "S-O STRATEGIES", icon: "fas fa-rocket",
                items: [
                    { summary: "Strategi Pengurangan Bus / Standby Bus untuk mengurangi Fuel", details: ["Target: Cost Saving"] },
                    { summary: "Opportunity penambahan Volume diluar JSO dengan alat standby", details: ["Target: Revenue Boost"] },
                    { summary: "Percepatan slippery OB dengan distace relative pendek (1200 meter)", details: ["Target: Productivity"] },
                    { summary: "Percepatan slippery Coal lebih cepat dengan jalan hauling AGM yang sudah di AWR", details: ["Target: Coal Flow"] },
                    { summary: "Start Change Shift pada Pukul 06:02/18:02", details: ["Target: Effective Working Hours"] },
                    { summary: "Pengurangan Running D375 dari 3 ke 2", details: ["Target: Efficiency"] }
                ] 
            },
            wo: { 
                title: "W-O STRATEGIES", icon: "fas fa-sync-alt",
                items: [
                    { summary: "Memperkuat pengamanan Aset Standby dengan Wakar / CCTV", details: ["Target: Zero Theft"] },
                    { summary: "Melaksanakan STO segera mungkin menjelang Mine Closure AGM ke DC Palaran", details: ["Target: Asset Accuracy"] },
                    { summary: "Menginstall Fiber Optic untuk koneksi Office Warutas", details: ["Target: Stable Connection"] },
                    { summary: "Pembuatan 4M1E AGM 2026", details: ["Target: Better Planning"] },
                    { summary: "Menurunkan Nilai Safety Stock Fuel untuk tahun 2026", details: ["Target: Inventory Cost Reduction"] }
                ] 
            },
            st: { 
                title: "S-T STRATEGIES", icon: "fas fa-random",
                items: [
                    { summary: "Membuat infra struktur (Pit Stop) di Pit Warutas", details: ["Target: Reduce Travel Time"] },
                    { summary: "Membuat Budget Operasional dibawah standart parameter untuk mendapatkan EBITDA", details: ["Target: Positive Margin"] },
                    { summary: "Rekayasa engineering Pemindahan Lumpur Loading jarak Pendek", details: ["Target: Mud Handling Efficiency"] }
                ] 
            },
            wt: { 
                title: "W-T STRATEGIES", icon: "fas fa-shield-alt",
                items: [
                    { summary: "Koordinasi dengan AGM untuk pengurangan Volume Design 2026 diganti dengan pekerjaan General", details: ["Target: Work Volume Adjustment"] },
                    { summary: "Pemasangan Pagar Pengamanan pada Asset IT pada Area KUD", details: ["Target: Asset Security"] },
                    { summary: "Utiliasasi Part Over to DC Palaran value 11 M", details: ["Target: Deadstock Recovery"] }
                ] 
            }
        };

        const bscData = {
            financial: { 
                title: "FINANCIAL", 
                uom: ["%", "%", "%", "%", "$/Bcm", "$/Ton", "Ratio", "%"],
                columns: ["REVENUE", "EBITDA", "EBT", "EAT", "COST OB", "COST CO", "CASH FLOW", "TAX ACCURACY"], 
                rows: [
                    [85, 88, 103, 86, 103, 84, 98, 102, 85, 68], 
                    [-9, -23, -70, -10, 15, 17, 46, 52, 22, -5], 
                    [-120, -85, -149, -103, -29, -48, 4, 12, -42, -85], 
                    [-154, -109, -149, -133, -37, -61, 6, 4, -54, -110], 
                    [65, 50, 79, 61, 60, 80, 77, 74, 0, 0], 
                    [66, 59, 53, 57, 45, 54, 44, 36, 0, 0], 
                    [140, 162, 136, 144, 178, 143, 143, 148, 133, 120],
                    [null, null, null, null, null, null, null, null, null, null] 
                ] 
            },
            customer: { 
                title: "CUSTOMER", 
                uom: ["BCM", "Ton", "TonKm", "%", "%", "%", "Index"],
                columns: ["OB PRODUCTION", "COAL PRODUCTION", "CO HAULING", "SHE INDEX", "MINE DESIGN ACCURACY", "CSR", "CSI"], 
                rows: [
                    [88, 83, 105, 91, 108, 84, 107, 96, 74, 72], 
                    [122, 112, 98, 67, 83, 74, 74, 60, 115, 99], 
                    [null, null, null, null, null, null, null, null, null, null],
                    [89, 91, 96, 87, 86, 96, 97, 92, 91, 90], 
                    [89, 75, 64, 79, 91, 95, 98, 97, 97, 98], 
                    [null, null, null, null, null, null, null, null, null, null],
                    [66, 66, 66, 76, 73, 73, 73, 73, 73, 73] 
                ]
            },
            process: { 
                title: "INTERNAL PROCESS", 
                uom: ["%", "%", "%", "Jam", "%", "%", "%", "Hari", "Bcm/Mp", "%", "Day", "%", "%", "%"],
                columns: ["PDTY LOADER", "PDTY HAULER", "RITASE", "EWH", "UA", "PA MINING", "PA HAULING", "ITO", "PRODUCTIVTY MP", "GMP", "LEADTIME BA", "SR", "5S/5R", "AnB"], 
                rows: [
                    [79, 83, 87, 83, 93, 98, 97, 98, 93, 88], 
                    [77, 77, 73, 75, 91, 92, 92, 100, 99, 91], 
                    [null, null, null, null, null, null, null, null, null, null],
                    [87, 96, 114, 96, 94, 112, 118, 115, 108, 113], 
                    [90, 89, 61, 74, 65, 148, 172, 152, 77, 135], 
                    [94, 97, 105, 97, 95, 95, 94, 92, 100, null], 
                    [null, null, null, null, null, null, null, null, null, null],
                    [66, 44, 45, 42, 55, 45, 53, 59, 78, 90], 
                    [151, 91, 84, 71, 73, 79, 76, 98, 118, 89], 
                    [94, 93, 89, 91, 95, 97, 99, 98, 97, 100],
                    [100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
                    [102, 101, 105, 102, 103, 105, 102, 100, 97, 86],
                    [76, 80, 69, 82, 85, 78, 86, 86, 84, 84],
                    [null, null, null, null, null, null, null, null, null, null]
                ] 
            },
            growth: { 
                title: "LEARNING & GROWTH", 
                uom: ["%", "%", "%", "%"],
                columns: ["FULLFIMENT COMPETENCY", "OPTIMIZING APPLICATION PERFORMANCE", "STRATEGY MANAGEMENT EFFECTIVENESS (SME)", "COVERAGE SYSTEM"], 
                rows: [
                    [109, 116, 111, 92, 118, 107, 74, 79, 54, 52], 
                    [0, 46, 83, 111, 92, 96, 103, 109, 107, 107], 
                    [0, 0, 49, 21, 24, 74, 71, 84, 74, 73], 
                    [107, 107, 107, 107, 118, 113, 107, 110, 110, 110]
                ] 
            }
        };

        const kpiPlans = {
            "OB PRODUCTION": [1311960, 1416367, 887879, 912821, 1014758, 1006123, 1137902, 1096959, 923387, 961589],
            "COAL PRODUCTION": [188739, 226110, 204172, 271992, 314590, 263217, 292524, 227757, 203506, 211721],
            "EWH": 16.63,
            "UA": 65,
            "ITO": 45,
            "LEADTIME": 7
        };

        const modal = document.getElementById('modalOverlay');
        const mTitle = document.getElementById('mTitle');
        const mBody = document.getElementById('mBody');
        let miniChartInstances = [];

        function toggleAccordion(header) {
            const item = header.parentElement;
            const content = item.querySelector('.accordion-content');
            if (item.classList.contains('accordion-active')) {
                item.classList.remove('accordion-active');
                content.style.maxHeight = null;
            } else {
                item.classList.add('accordion-active');
                content.style.maxHeight = content.scrollHeight + "px";
            }
        }

        function openModal(key) {
            const data = swotData[key];
            mTitle.innerText = data.title;
            let html = '<div style="padding: 10px;">';
            data.items.forEach(item => {
                let summary = typeof item === 'string' ? item : item.summary;
                let details = typeof item === 'object' && item.details ? item.details : [];
                html += `
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title"><i class="${data.icon}" style="color:var(--vc-gold); margin-right:10px;"></i> ${summary}</div>
                            <i class="fas fa-chevron-down accordion-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="accordion-body">
                                ${details.length > 0 ? `<ul class="acc-list">${details.map(d => `<li>${d}</li>`).join('')}</ul>` : 'No additional details.'}
                            </div>
                        </div>
                    </div>`;
            });
            html += '</div>';
            mBody.innerHTML = html;
            modal.classList.add('active');
        }

        function openBSC(key) {
            const data = bscData[key];
            mTitle.innerText = data.title;
            miniChartInstances.forEach(c => c.destroy());
            miniChartInstances = [];
            let html = `<div class="kpi-grid">`;
            data.columns.forEach((col, index) => {
                const values = data.rows[index];
                const validValues = values.filter(v => v !== null);
                const lastVal = validValues.length > 0 ? validValues[validValues.length - 1] : '-';
                let sum = 0; let count = 0;
                validValues.forEach(v => { sum += v; count++; });
                let ytd = count > 0 ? (sum / count).toFixed(0) : 0;
                let badgeClass = 'ytd-bad';
                if(ytd >= 100) badgeClass = 'ytd-good'; else if(ytd >= 99) badgeClass = 'ytd-warn';
                let isGood = true;
                if(validValues.length > 1) { if(validValues[validValues.length-1] < validValues[validValues.length-2]) isGood = false; }
                if(col.includes("COST") || col.includes("ITO")) isGood = !isGood;
                const color = isGood ? '#27ae60' : '#d63031'; 
                html += `<div class="kpi-card"><div class="kpi-title" title="${col}">${col}</div><div class="ytd-badge ${badgeClass}">Avg Achv: ${ytd}%</div><div class="kpi-stat-row"><div class="kpi-current" style="color:${color}">${lastVal !== '-' ? lastVal + '%' : '-'}</div></div><div class="mini-chart-container"><canvas id="miniChart-${index}"></canvas></div></div>`;
            });
            html += `</div>`;
            mBody.innerHTML = html;
            modal.classList.add('active');
            setTimeout(() => {
                data.columns.forEach((col, index) => {
                    const ctx = document.getElementById(`miniChart-${index}`).getContext('2d');
                    const values = data.rows[index];
                    const uom = data.uom[index];
                    const targetData = values.map(() => 100);
                    const validVals = values.filter(v => v !== null);
                    const lastVal = validVals[validVals.length - 1];
                    let borderColor = '#27ae60'; let bgColor = 'rgba(39, 174, 96, 0.1)';
                    if (typeof lastVal === 'number') {
                        let isBad = lastVal < 99;
                        if(col.includes("COST")) isBad = lastVal > 100;
                        if (isBad) { borderColor = '#d63031'; bgColor = 'rgba(214, 48, 49, 0.1)'; }
                    }
                    const chart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct'],
                            datasets: [{ label: col, data: values, borderColor: borderColor, backgroundColor: bgColor, borderWidth: 2, tension: 0.3, fill: true, pointRadius: 4, pointHoverRadius: 6, pointBackgroundColor: '#181818', pointBorderColor: borderColor, pointBorderWidth: 2 }, { label: 'Target', data: targetData, borderColor: '#666', borderWidth: 1, borderDash: [4, 4], pointRadius: 0, fill: false }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false },
                            plugins: { legend: { display: false }, tooltip: { enabled: true, backgroundColor: 'rgba(0,0,0,0.9)', titleFont: { family: 'Lato', size: 13 }, bodyFont: { family: 'Lato', size: 12 }, displayColors: false, callbacks: { title: function(context) { return context[0].label; }, label: function(context) { let label = context.dataset.label || ''; let ach = context.parsed.y; if (label === 'Target') return null; let planVal = null; let actVal = null; let monthIndex = context.dataIndex; let foundKey = Object.keys(kpiPlans).find(k => label.includes(k)); if (foundKey) { if(Array.isArray(kpiPlans[foundKey])) { planVal = kpiPlans[foundKey][monthIndex]; } else { planVal = kpiPlans[foundKey]; } if(label.includes("ITO") || label.includes("LEADTIME")) { if(ach > 0) actVal = (planVal / (ach/100)).toFixed(1); } else { actVal = (planVal * (ach/100)).toFixed(0); } if (actVal > 9999) { actVal = (actVal/1000).toFixed(0) + 'k'; planVal = (planVal/1000).toFixed(0) + 'k'; } return `Plan: ${planVal} ${uom}, Actual: ${actVal} ${uom}`; } if (ach !== null) { return `Ach: ${ach}% (Target: 100%)`; } return null; } } } },
                            scales: { x: { display: true, grid: { color: '#333', lineWidth: 0.5 }, ticks: { color: '#888', font: { size: 9 } } }, y: { display: true, position: 'right', grid: { color: '#333', borderDash: [2, 4] }, ticks: { color: '#555', font: { size: 9 }, callback: function(value) { return value + '%' } } } },
                            layout: { padding: { top: 10, right: 10 } }
                        }
                    });
                    miniChartInstances.push(chart);
                });
            }, 200);
        }
        function closeModal() { modal.classList.remove('active'); }
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
        function savePage() { const htmlContent = document.documentElement.outerHTML; const blob = new Blob([htmlContent], { type: 'text/html' }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'agm_dashboard_saved.html'; document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url); }
    </script>

</body></html>